---
category: 数据库
---

## Mysql与B+树(2)

在[Mysql与B+树(1)](https://yedong666.github.io/blogs/%E6%95%B0%E6%8D%AE%E5%BA%93/2022/02/13/Mysql%E4%B8%8EB+%E6%A0%91(1).html)中我讲了一些自己对Mysql和B+树的理解和思考，捋清楚其底层的逻辑之后，我发现以前许多疑惑的问题或者概念都可以据此一一回答和解决。

### 什么是回表？

Mysql在查询数据时，不考虑缓存之类的其它影响，最终都是需要通过主键索引来获取到数据或是对应数据指针。主键索引也叫聚簇索引，它是由Mysql在表的创建之初的被生成的。

除了聚簇索引以外，我们以可以根据自己的需要创建索引，其中的元素可以是每个元组的一个字段，也可以是多个字段；有了这些索引我们在进行和这些字段相关的查询时，可以通过我们建立的这个索引树查到对应的主键id，然后再去主键索引树里查找数据。这样做避免了全表扫描，既减少了磁盘IO也减少了CPU执行时间。

至于什么是全表扫描，上述做法又是如何减少了磁盘IO也减少了CPU执行时间的呢？举一个例子就明白了。

假设我要根据名字在一张表里面查找一个人的身份信息，在没有建立其名字对应的索引以前Mysql会怎么做呢？

它需要从主键索引树的第一个叶子结点的第一个元素开始，遍历整张表的索引元素，直到找到满足名字相同的数据为止。这就是全表扫描。Mysql每次和磁盘交互的数据大小是16KB，一般来说，它会对应一个结点内的数据。假设该表的数据量下，索引树高为3，查找的数据在第k个叶子结点，每个结点的元素个数是m, 在非叶子结点评价遍历的元素个数是a。那么全表扫描的IO次数至少是k+3；

